# 项目维护指南

## 🎯 项目定位

这是一个**课程资料共享项目**，旨在：
- 收集和整理各门课程的学习资料
- 提供选课建议和学习经验
- 方便学弟学妹查找和使用资料

## 🔄 维护方式

### 方式一：GitHub Actions 自动维护（推荐）

**工作原理**：
1. 有人提交新文件到 GitHub
2. GitHub Actions 自动触发
3. 运行 `更新README资料.py` 脚本
4. 自动更新所有 README 文件
5. 自动提交更改

**优点**：
- ✅ 完全自动化，无需人工干预
- ✅ 每次提交后自动更新
- ✅ 保持 README 始终最新

**配置**：
- 已配置 `.github/workflows/update-readme.yml`
- 需要确保仓库设置中 Actions 已启用
- 需要确保有写入权限（默认使用 `GITHUB_TOKEN`）

### 方式二：本地维护

**适用场景**：
- 本地开发测试
- 批量添加大量文件
- 需要预览效果

**步骤**：
1. 添加文件到对应课程目录
2. 运行 `python 更新README资料.py` 或双击 `运行更新README.bat`
3. 检查生成的 README
4. 提交更改

### 方式三：手动维护

**适用场景**：
- 更新选课建议（脚本不会修改这部分）
- 添加特殊说明
- 修复格式问题

**步骤**：
1. 直接编辑对应课程的 `README.md`
2. 提交更改

## 📁 目录结构

```
项目根目录/
├── .github/
│   └── workflows/
│       └── update-readme.yml    # GitHub Actions 配置
├── 课程目录1/
│   ├── README.md                # 课程说明（自动更新资料部分）
│   └── [课程资料文件]
├── 课程目录2/
│   └── ...
├── 更新README资料.py            # 自动更新脚本
├── 运行更新README.bat           # Windows 批处理文件
├── CONTRIBUTING.md              # 贡献指南
└── README.md                    # 项目主说明
```

## 🔧 脚本工作原理

### 1. 文件扫描

脚本会：
- 扫描所有课程目录（有 README.md 的目录）
- 递归扫描子目录（最多3层）
- 忽略系统文件和临时文件

### 2. 文件分类

根据以下规则分类：
- **关键词匹配**：检查文件名中的关键词（作业、实验、期末等）
- **文件扩展名**：根据文件类型判断
- **目录结构**：识别子目录中的文件

### 3. 描述生成

- 清理文件名（移除学号、姓名等）
- 简化路径描述
- 按类别组织

### 4. README 更新

- 保留"选课建议"部分不变
- 更新"资料介绍"部分
- 移除旧的"资料扩展记录"部分

## 🚀 部署到 GitHub

### 1. 初始设置

```bash
# 1. 创建仓库
git init
git add .
git commit -m "初始提交"

# 2. 添加远程仓库
git remote add origin https://github.com/your-username/your-repo.git
git branch -M main
git push -u origin main
```

### 2. 启用 GitHub Actions

1. 进入仓库 Settings
2. 找到 Actions → General
3. 确保 "Allow all actions and reusable workflows" 已启用
4. 在 "Workflow permissions" 中选择 "Read and write permissions"

### 3. 测试自动化

1. 添加一个测试文件到某个课程目录
2. 提交并推送：
   ```bash
   git add .
   git commit -m "test: 测试自动更新"
   git push
   ```
3. 查看 Actions 标签页，应该能看到工作流运行
4. 检查 README 是否自动更新

## 📊 维护检查清单

### 定期检查（每月）

- [ ] 检查 GitHub Actions 是否正常运行
- [ ] 查看是否有失败的构建
- [ ] 检查 README 格式是否正确
- [ ] 查看是否有重复或过时的资料

### 添加新课程时

- [ ] 创建课程目录
- [ ] 创建 README.md（使用模板）
- [ ] 添加初始资料
- [ ] 测试脚本是否能正确识别

### 更新脚本时

- [ ] 在本地测试脚本
- [ ] 检查是否有破坏性更改
- [ ] 更新文档说明
- [ ] 提交更改并测试 GitHub Actions

## 🐛 常见问题

### Q: GitHub Actions 没有自动运行？

**A**: 检查：
1. Actions 是否已启用（Settings → Actions）
2. 工作流文件路径是否正确（`.github/workflows/update-readme.yml`）
3. 提交是否触发了工作流（查看 Actions 标签页）

### Q: 脚本分类不正确？

**A**: 
1. 检查文件名是否包含关键词
2. 可以在脚本的 `FILE_CATEGORIES` 字典中添加更多关键词
3. 或者修改文件名使其包含相应关键词

### Q: README 格式乱了？

**A**:
1. 检查脚本是否有错误
2. 查看 GitHub Actions 的日志
3. 手动修复格式后提交

### Q: 如何只更新某个课程？

**A**: 可以修改脚本，在 `main()` 函数中指定要更新的目录：

```python
# 只更新特定课程
course_dirs = [BASE_PATH / "课程名称"]
for course_dir in course_dirs:
    update_readme(course_dir)
```

## 🔐 权限和安全

### GitHub Token

- 默认使用 `GITHUB_TOKEN`（GitHub 自动提供）
- 权限：`contents: write`（写入内容）
- 无需额外配置

### 文件权限

- 脚本只读取和写入 README.md 文件
- 不会删除或修改其他文件
- 不会访问敏感信息

## 📈 未来改进

可以考虑的功能：

1. **增量更新**：只更新有变化的目录
2. **更智能的分类**：使用机器学习识别文件类型
3. **文件大小检查**：自动检测大文件并提示
4. **重复检测**：检测并提示重复文件
5. **Web 界面**：提供网页界面方便管理

## 📞 联系方式

如有问题或建议，请：
- 提交 Issue
- 提交 Pull Request
- 联系项目维护者

---

**记住**：这个项目的目标是让资料共享变得简单，自动化是关键！
